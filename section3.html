
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introducción a Dash &#8212; Maestría en Estadística Aplicada</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Visualización interactiva de datos geográficos" href="section2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Maestría en Estadística Aplicada</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Pre-requisitos
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="section1.html">
   Introducción a la visualización de datos con Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="section2.html">
   Visualización interactiva de datos geográficos
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introducción a
   <code class="docutils literal notranslate">
    <span class="pre">
     Dash
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/section3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/section3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Introducción a
   <code class="docutils literal notranslate">
    <span class="pre">
     Dash
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#introduccion">
     Introducción
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#configuracion-de-su-entorno">
     Configuración de su entorno
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diseno-de-dash">
     Diseño de Dash
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mas-informacion-sobre-los-componentes-html">
     Más información sobre los componentes HTML
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#componentes-reutilizables">
     Componentes reutilizables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mas-informacion-sobre-la-visualizacion">
     Más información sobre la visualización
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#markdown">
     Markdown
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#componentes-principales">
     Componentes principales
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#callbacks-basicos-dash">
   Callbacks básicos Dash
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dash-app-layout-con-figura-y-sliderm">
     Dash App Layout con Figura y Sliderm
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aplicacion-dash-con-multiples-entradas">
     Aplicación Dash con múltiples entradas
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aplicacion-dash-con-multiples-salidas">
     Aplicación Dash con múltiples salidas
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dash-app-con-callbacks-encadenados">
     Dash App con callbacks encadenados
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dash-app-con-estado">
     Dash App con Estado
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actualizar-graficos-al-deslizar-el-cursor">
     Actualizar gráficos al deslizar el cursor
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dos-ejemplos-de-dash">
   Dos ejemplos de Dash
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dash-app-para-mapas">
     Dash App para Mapas
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dash-app-financiera">
     Dash App Financiera
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#despliegue-de-dash-app">
   Despliegue de Dash App
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tutorial">
     Tutorial
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <h1>Tabla de contenido<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Introducción-a-Dash" data-toc-modified-id="Introducción-a-Dash-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Introducción a <code>Dash</code></a></span><ul class="toc-item"><li><span><a href="#Introducción" data-toc-modified-id="Introducción-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Introducción</a></span></li><li><span><a href="#Configuración-de-su-entorno" data-toc-modified-id="Configuración-de-su-entorno-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Configuración de su entorno</a></span></li><li><span><a href="#Diseño-de-Dash" data-toc-modified-id="Diseño-de-Dash-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Diseño de Dash</a></span></li><li><span><a href="#Más-información-sobre-los-componentes-HTML" data-toc-modified-id="Más-información-sobre-los-componentes-HTML-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Más información sobre los componentes HTML</a></span></li><li><span><a href="#Componentes-reutilizables" data-toc-modified-id="Componentes-reutilizables-1.5"><span class="toc-item-num">1.5&nbsp;&nbsp;</span>Componentes reutilizables</a></span></li><li><span><a href="#Más-información-sobre-la-visualización" data-toc-modified-id="Más-información-sobre-la-visualización-1.6"><span class="toc-item-num">1.6&nbsp;&nbsp;</span>Más información sobre la visualización</a></span></li><li><span><a href="#Markdown" data-toc-modified-id="Markdown-1.7"><span class="toc-item-num">1.7&nbsp;&nbsp;</span>Markdown</a></span></li><li><span><a href="#Componentes-principales" data-toc-modified-id="Componentes-principales-1.8"><span class="toc-item-num">1.8&nbsp;&nbsp;</span>Componentes principales</a></span></li></ul></li><li><span><a href="#Callbacks-básicos-Dash" data-toc-modified-id="Callbacks-básicos-Dash-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Callbacks básicos Dash</a></span><ul class="toc-item"><li><span><a href="#Dash-App-Layout-con-Figura-y-Sliderm" data-toc-modified-id="Dash-App-Layout-con-Figura-y-Sliderm-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Dash App Layout con Figura y Sliderm</a></span></li><li><span><a href="#Aplicación-Dash-con-múltiples-entradas" data-toc-modified-id="Aplicación-Dash-con-múltiples-entradas-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Aplicación Dash con múltiples entradas</a></span></li><li><span><a href="#Aplicación-Dash-con-múltiples-salidas" data-toc-modified-id="Aplicación-Dash-con-múltiples-salidas-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Aplicación Dash con múltiples salidas</a></span></li><li><span><a href="#Dash-App-con-callbacks-encadenados" data-toc-modified-id="Dash-App-con-callbacks-encadenados-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Dash App con callbacks encadenados</a></span></li><li><span><a href="#Dash-App-con-Estado" data-toc-modified-id="Dash-App-con-Estado-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>Dash App con Estado</a></span></li><li><span><a href="#Actualizar-gráficos-al-deslizar-el-cursor" data-toc-modified-id="Actualizar-gráficos-al-deslizar-el-cursor-2.6"><span class="toc-item-num">2.6&nbsp;&nbsp;</span>Actualizar gráficos al deslizar el cursor</a></span></li></ul></li><li><span><a href="#Dos-ejemplos-de-Dash" data-toc-modified-id="Dos-ejemplos-de-Dash-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Dos ejemplos de Dash</a></span><ul class="toc-item"><li><span><a href="#Dash-App-para-Mapas" data-toc-modified-id="Dash-App-para-Mapas-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Dash App para Mapas</a></span></li><li><span><a href="#Dash-App-Financiera" data-toc-modified-id="Dash-App-Financiera-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Dash App Financiera</a></span></li></ul></li><li><span><a href="#Despliegue-de-Dash-App" data-toc-modified-id="Despliegue-de-Dash-App-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Despliegue de Dash App</a></span><ul class="toc-item"><li><span><a href="#Tutorial" data-toc-modified-id="Tutorial-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Tutorial</a></span></li></ul></li></ul></div><div class="section" id="introduccion-a-dash">
<h1>Introducción a <code class="docutils literal notranslate"><span class="pre">Dash</span></code><a class="headerlink" href="#introduccion-a-dash" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduccion">
<h2>Introducción<a class="headerlink" href="#introduccion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Descargado 600.000 veces al mes, Dash es el marco original de bajo código para construir rápidamente aplicaciones de datos en <code class="docutils literal notranslate"><span class="pre">Python,</span> <span class="pre">R,</span> <span class="pre">Julia</span> <span class="pre">y</span> <span class="pre">F#.</span></code></p></li>
<li><p>Escrito sobre <code class="docutils literal notranslate"><span class="pre">Plotly.js</span></code> y <code class="docutils literal notranslate"><span class="pre">React.js</span></code>, <code class="docutils literal notranslate"><span class="pre">Dash</span></code> es ideal para construir y desplegar aplicaciones de datos con interfaces de usuario personalizadas en <code class="docutils literal notranslate"><span class="pre">Python,</span> <span class="pre">R,</span> <span class="pre">Julia</span></code> o <code class="docutils literal notranslate"><span class="pre">F#</span></code>. Es particularmente adecuado para cualquiera que trabaje con datos.</p></li>
<li><p>A través de un par de patrones simples, <code class="docutils literal notranslate"><span class="pre">Dash</span></code> abstrae todas las tecnologías y protocolos que se requieren para construir una aplicación web full-stack con visualización de datos interactivos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dash</span></code> es lo suficientemente sencillo como para que puedas vincular una interfaz de usuario a tu código <code class="docutils literal notranslate"><span class="pre">Python,</span> <span class="pre">R,</span> <span class="pre">Julia</span></code> o <code class="docutils literal notranslate"><span class="pre">F#</span></code> en menos de 10 minutos.</p></li>
<li><p>Las aplicaciones de <code class="docutils literal notranslate"><span class="pre">Dash</span></code> se muestran en el navegador web. Puedes desplegar tus aplicaciones en máquinas virtuales o clusters Kubernetes y luego compartirlas a través de URLs. Dado que las aplicaciones de <code class="docutils literal notranslate"><span class="pre">Dash</span></code> se ven en el navegador web, <code class="docutils literal notranslate"><span class="pre">Dash</span></code> es intrínsecamente multiplataforma y está preparado para los dispositivos móviles.</p></li>
<li><p>Hay mucho detrás del framework. Para saber más sobre cómo está construido y qué motivó a <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, lea el post <a class="reference external" href="https://medium.com/plotly/dash-is-react-for-python-r-and-julia-c75822d1cc24">Dash es React para Python</a>. Puede encontrar distintos templates de <code class="docutils literal notranslate"><span class="pre">Dash</span></code> en el siguiente link, los cuales puedes utlizar para tus proyectos: <a class="reference external" href="https://dash.gallery/Portal/">Dash Enterprise App Gallery</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dash</span></code> es una librería de código abierto liberada bajo la permisiva licencia MIT. <code class="docutils literal notranslate"><span class="pre">Plotly</span></code> desarrolla <code class="docutils literal notranslate"><span class="pre">Dash</span></code> y también ofrece una plataforma para escribir y desplegar aplicaciones <code class="docutils literal notranslate"><span class="pre">Dash</span></code> en un entorno empresarial.</p></li>
</ul>
<p><img alt="" src="_images/dash1.png" /></p>
</div>
<div class="section" id="configuracion-de-su-entorno">
<h2>Configuración de su entorno<a class="headerlink" href="#configuracion-de-su-entorno" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Para la isntalación de <code class="docutils literal notranslate"><span class="pre">Dash</span></code> crearemos un entorno especial, en el cual isntalaremos cada una de las librería que necesitaremos en el transcurso de esta sección, en especial la isntalación de <code class="docutils literal notranslate"><span class="pre">Dash</span></code> mediante la orden: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">dash</span></code>. En su esencia, el propósito principal de los entornos virtuales (enviroment) de <code class="docutils literal notranslate"><span class="pre">Python</span></code> es crear un entorno aislado para los proyectos de <code class="docutils literal notranslate"><span class="pre">Python</span></code>. Esto significa que cada proyecto puede tener sus propias dependencias, independientemente de las dependencias que tengan los demás proyectos. Lo bueno de esto es que no hay límites en el número de entornos que puedes tener, ya que sólo son directorios que contienen unos pocos scripts. Además, son fácilmente creados usando las herramientas de línea de comandos <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> o <code class="docutils literal notranslate"><span class="pre">pyenv</span></code>, en el caso de <code class="docutils literal notranslate"><span class="pre">anaconda</span></code> por medio de <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span></code></p></li>
</ul>
<ul class="simple">
<li><p>Crea un enviroment virtual de <code class="docutils literal notranslate"><span class="pre">Python</span></code> en una carpeta llamada <code class="docutils literal notranslate"><span class="pre">dash_project</span></code> (o cualquier otro nombre que quieras). Esto también creará una nueva carpeta con el nombre que hayas elegido. Escriba la siguiente orden un su terminal, en el caso de <code class="docutils literal notranslate"><span class="pre">Windows</span></code>, en el <strong>Command Prompt</strong> o en el <strong>Windows PowerShell</strong> que tiene un aspecta muy parecido al de <code class="docutils literal notranslate"><span class="pre">Ubuntu</span></code>. Puedes elegir la carpeta donde van a reposar todos tus <code class="docutils literal notranslate"><span class="pre">enviroment</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash2.png" /></p>
<ul class="simple">
<li><p>Luego nos vamos a mover a la carpeta que se creó con el enviroment: <strong>dash_project</strong> usando el comando <code class="docutils literal notranslate"><span class="pre">cd</span></code>, y dentro de esta vamos a ejecutar la siguiente orden para activar en enviroment: <code class="docutils literal notranslate"><span class="pre">.\Scripts\activate</span></code> tal como se muestra en la figura. Notese que en la parte izquierda de la linea de comandos, aparece el nombre del enviroment en color verde, indicando que ha sido creado correctamente y está activado. Luego de activado el enviroment se puede mover al directorio donde desea realizar el desarrollo de esta sección, antes istalaremos algunos librerías</p></li>
</ul>
<p><img alt="" src="_images/dash3.png" /></p>
<ul class="simple">
<li><p>En su terminal, instale dash.</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install dash
</pre></div>
</div>
<ul class="simple">
<li><p>Esto también trae consigo la biblioteca de gráficos plotly. Esta biblioteca está en desarrollo activo, así que instala y actualiza con frecuencia. Si prefieres Jupyter notebook o JupyterLab como entorno de desarrollo, te recomendamos instalar jupyter-dash:</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install jupyter-dash
</pre></div>
</div>
<ul class="simple">
<li><p>También recomendamos instalar <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>, que es requerido por <code class="docutils literal notranslate"><span class="pre">Plotly</span> <span class="pre">Express</span></code> y utilizado en muchos de nuestros ejemplos.</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install pandas
</pre></div>
</div>
<ul class="simple">
<li><p>Estamos listos para crear nuestra primera aplicación Dash. Cada una de estas librerías pueden ser isntaladas también a traves de un archivo con requerimientos, el cual podemos crear con el nombre: <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> y copiar en éste sin espacio a la izquierda el nombre de cada librería, así:</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dash
jupyter-dash
pandas
</pre></div>
</div>
<ul class="simple">
<li><p>Luego desde la línea de comando ejecutar</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
<ul class="simple">
<li><p>Estaremos usando en esta sección <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> debido a que es gratis. Otras opciones son: <code class="docutils literal notranslate"><span class="pre">Sublime,</span> <span class="pre">VS</span> <span class="pre">Code,</span> <span class="pre">Atom</span></code> entre otras. Seleccione aquel editor con el que se sienta más comodo. Para instalar <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> escriba dentro del mismo enviroment</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install jupyterlab
</pre></div>
</div>
<p><img alt="" src="_images/dash4.png" /></p>
<ul class="simple">
<li><p>Iniciamos <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> para crear el archivo <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> con las librerías a instalar. Éste archivo podemos ir actualizandolo en el transcurso de la sección a medida que una nueva librería va siendo necesaria.</p></li>
</ul>
<p><img alt="" src="_images/dash5.png" />
<img alt="" src="_images/dash6.png" /></p>
<ul class="simple">
<li><p>Crea el archivo <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> con librerías a instalar. Nótese que <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code> cuenta también con una terminal integrada, por lo tanto, luego de crear el archivo, puede abrir una terminal dentro de <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code>, activar el enviroment y luego instalar las librerías usando <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash7.png" /></p>
</div>
<div class="section" id="diseno-de-dash">
<h2>Diseño de Dash<a class="headerlink" href="#diseno-de-dash" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Estudiaremos el diseño a través de seis aplicaciones autónomas. El diseño de las aplicaciones <code class="docutils literal notranslate"><span class="pre">Dash</span></code> de producción puede ser estilizado con <a class="reference external" href="https://plotly.com/dash/design-kit/?tab=templates">Dash Enterprise Design Kit</a>. Las aplicaciones <code class="docutils literal notranslate"><span class="pre">Dash</span></code> se componen de dos partes. La primera parte es el “diseño” de la aplicación y describe el aspecto de la misma. La segunda parte describe la interactividad de la aplicación y será cubierta más adelante.</p></li>
<li><p>Mantenemos un conjunto de componentes en la biblioteca <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> y <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) pero también puedes construir los suyos con <code class="docutils literal notranslate"><span class="pre">JavaScript</span></code> y <code class="docutils literal notranslate"><span class="pre">React.js</span></code>. A lo largo de esta sección, los ejemplos de código <code class="docutils literal notranslate"><span class="pre">Python</span></code> están pensados para ser guardados como archivos y ejecutados usando <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">app.py</span></code>. También puedes usar <code class="docutils literal notranslate"><span class="pre">Jupyter</span></code> con la biblioteca <code class="docutils literal notranslate"><span class="pre">JupyterDash</span></code>.</p></li>
<li><p>Para empezar, crea un archivo llamado <code class="docutils literal notranslate"><span class="pre">app.py</span></code>, copia el código de abajo en él y ejecútalo con <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">app.py</span></code> luego visite <a class="reference external" href="http://127.0.0.1:8050/">http://127.0.0.1:8050/</a> en su navegador web para ver la aplicación</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Fruit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Apples&quot;</span><span class="p">,</span> <span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="s2">&quot;Bananas&quot;</span><span class="p">,</span> <span class="s2">&quot;Apples&quot;</span><span class="p">,</span> <span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="s2">&quot;Bananas&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s2">&quot;City&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fruit&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Amount&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;City&quot;</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="p">[</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="s1">&#39;Hello Dash&#39;</span><span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        Dash: A web application framework for your data.</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">),</span>

    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;example-graph&#39;</span><span class="p">,</span>
        <span class="n">figure</span><span class="o">=</span><span class="n">fig</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash8.png" />
<img alt="" src="_images/dash9.png" />
<img alt="" src="_images/dash10.png" />
<img alt="" src="_images/dash11.png" /></p>
<ul class="simple">
<li><p>Para tener otro estilo de visualización puede diseñar tu propio archivos <code class="docutils literal notranslate"><span class="pre">style.css</span></code> por jemplo, o utlizar algunos libres que puedes sólo importar, como por ejemplo <a class="reference external" href="https://www.bootstrapcdn.com/bootswatch/">BootstrapCDN</a> y <a class="reference external" href="https://plotly.com/python/templates/">Plotly themes</a>. Para importar los estilos de temas en tu app debe importar la librería en el el <code class="docutils literal notranslate"><span class="pre">.py</span></code> principal de tu app: <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">dash_bootstrap_components</span> <span class="pre">as</span> <span class="pre">dbc</span></code>, ademas de usar la siguiente línea para selecionar el tema de interés</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span><span class="n">dbc</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">BOOTSTRAP</span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Antes debe instalarlo en el enviroment usando: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">dash-bootstrap-components</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash12.png" />
<img alt="" src="_images/dash13.png" /></p>
<p><strong>Observaciones</strong></p>
<ul class="simple">
<li><p>El diseño está compuesto por un árbol de “componentes” como <code class="docutils literal notranslate"><span class="pre">html.Div</span></code> y <code class="docutils literal notranslate"><span class="pre">dcc.Graph</span></code>.</p></li>
<li><p>La biblioteca <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) tiene un componente para cada etiqueta <code class="docutils literal notranslate"><span class="pre">HTML</span></code>. El componente <code class="docutils literal notranslate"><span class="pre">html.H1(children</span> <span class="pre">=</span> <span class="pre">'Hola</span> <span class="pre">Dash')</span></code> genera un elemento <code class="docutils literal notranslate"><span class="pre">HTML</span> <span class="pre">&lt;h1&gt;Hola</span> <span class="pre">Dash&lt;/h1&gt;</span></code> en tu aplicación. <code class="docutils literal notranslate"><span class="pre">h1</span></code> en <code class="docutils literal notranslate"><span class="pre">HTML</span></code> es el primer nivel de encabezado en una página web.</p></li>
<li><p>No todos los componentes son <code class="docutils literal notranslate"><span class="pre">HTML</span></code> puro. Los <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> describen componentes de nivel superior que son interactivos y se generan con <code class="docutils literal notranslate"><span class="pre">JavaScript,</span> <span class="pre">HTML</span></code> y <code class="docutils literal notranslate"><span class="pre">CSS</span></code> a través de la biblioteca <code class="docutils literal notranslate"><span class="pre">React.js</span></code>.</p></li>
<li><p>Cada componente se describe completamente a través de atributos de palabras clave. <code class="docutils literal notranslate"><span class="pre">Dash</span></code> es declarativo: usted describirá principalmente su aplicación a través de estos atributos.</p></li>
<li><p>La propiedad <code class="docutils literal notranslate"><span class="pre">children</span></code> es especial. Por convención, siempre es el primer atributo, lo que significa que puedes omitirlo: <code class="docutils literal notranslate"><span class="pre">html.H1(children</span> <span class="pre">=</span> <span class="pre">'Hello</span> <span class="pre">Dash')</span></code> es lo mismo que <code class="docutils literal notranslate"><span class="pre">html.H1('Hello</span> <span class="pre">Dash')</span></code>. Puede contener una cadena, un número, un solo componente o una lista de componentes.</p></li>
<li><p>Las fuentes en su aplicación se verán un poco diferentes de lo que se muestra en la imágen de arriba a menos que cambie el estilo de la hoja y de <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>. Esta aplicación está utilizando una hoja de estilos <code class="docutils literal notranslate"><span class="pre">BootstrapCDN</span></code> y temas <code class="docutils literal notranslate"><span class="pre">Plotly</span></code></p></li>
</ul>
<p><strong>Realizar tu primer cambio</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dash</span></code> incluye “hot-reloading”, esta característica se activa por defecto cuando ejecutas tu aplicación con <code class="docutils literal notranslate"><span class="pre">app.run_server(debug=True)</span></code>. Esto significa que <code class="docutils literal notranslate"><span class="pre">Dash</span></code> refrescará automáticamente tu navegador cuando hagas un cambio en tu código. Pruébalo: cambia el título “Hello Dash” en tu aplicación o cambia los datos <span class="math notranslate nohighlight">\(x\)</span> o <span class="math notranslate nohighlight">\(y\)</span>. Tu aplicación debería refrescarse automáticamente con tu cambio.</p></li>
</ul>
</div>
<div class="section" id="mas-informacion-sobre-los-componentes-html">
<h2>Más información sobre los componentes HTML<a class="headerlink" href="#mas-informacion-sobre-los-componentes-html" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) contiene una clase de componente para cada etiqueta <code class="docutils literal notranslate"><span class="pre">HTML</span></code>, así como argumentos de palabras clave para todos los argumentos <code class="docutils literal notranslate"><span class="pre">HTML</span></code>. Vamos a personalizar el texto de nuestra aplicación modificando los estilos en línea de los componentes. Crea un archivo llamado <code class="docutils literal notranslate"><span class="pre">app.py</span></code> con el siguiente código</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="s1">&#39;#111111&#39;</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;#7FDBFF&#39;</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Fruit&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Apples&quot;</span><span class="p">,</span> <span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="s2">&quot;Bananas&quot;</span><span class="p">,</span> <span class="s2">&quot;Apples&quot;</span><span class="p">,</span> <span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="s2">&quot;Bananas&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Amount&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s2">&quot;City&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Fruit&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Amount&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;City&quot;</span><span class="p">,</span> <span class="n">barmode</span> <span class="o">=</span> <span class="s2">&quot;group&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">plot_bgcolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span>
    <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">],</span>
    <span class="n">font_color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;backgroundColor&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">]},</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span>
        <span class="n">children</span> <span class="o">=</span> <span class="s1">&#39;Hello Dash&#39;</span><span class="p">,</span>
        <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;textAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">),</span>
    
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="n">children</span> <span class="o">=</span> <span class="s1">&#39;Dash: A web application framework for your data.&#39;</span><span class="p">,</span> <span class="n">style</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;textAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
    <span class="p">}),</span>
    
    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;example-graph-2&#39;</span><span class="p">,</span>
        <span class="n">figure</span><span class="o">=</span><span class="n">fig</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash14.png" /></p>
<ul class="simple">
<li><p>En este ejemplo, hemos modificado los estilos inline de los componentes <code class="docutils literal notranslate"><span class="pre">html.Div</span></code> y <code class="docutils literal notranslate"><span class="pre">html.H1</span></code> con la propiedad style.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s1">&#39;Hello Dash&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;textAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#7FDBFF&#39;</span><span class="p">})</span>
</pre></div>
</div>
<ul class="simple">
<li><p>El código anterior se muestra en la aplicación <code class="docutils literal notranslate"><span class="pre">Dash</span></code> como</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;text-align: center; color: #7FDBFF&quot;</span><span class="p">&gt;</span>Hola Dash<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>.
</pre></div>
</div>
<ul class="simple">
<li><p>Hay algunas diferencias importantes entre los componentes <code class="docutils literal notranslate"><span class="pre">dash_html_</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) y los atributos <code class="docutils literal notranslate"><span class="pre">HTML</span></code>:</p>
<ul>
<li><p>La propiedad de estilo en <code class="docutils literal notranslate"><span class="pre">HTML</span></code> es una cadena separada por punto y coma. En <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, sólo se puede proporcionar un diccionario.</p></li>
<li><p>Las claves (keys) en el diccionario de estilo son <a class="reference external" href="https://en.wikipedia.org/wiki/Camel_case">camelCased</a>. Así, en lugar de <code class="docutils literal notranslate"><span class="pre">text-align</span></code>, es <code class="docutils literal notranslate"><span class="pre">textAlign</span></code>. El atributo de clase <code class="docutils literal notranslate"><span class="pre">HTML</span></code> es <code class="docutils literal notranslate"><span class="pre">className</span></code> en <code class="docutils literal notranslate"><span class="pre">Dash</span></code>.</p></li>
<li><p>Los hijos (children) de la etiqueta <code class="docutils literal notranslate"><span class="pre">HTML</span></code> se especifican a través del argumento de la palabra clave children. Por convención, éste es siempre el primer argumento, por lo que a menudo se omite.</p></li>
<li><p>Además de esto, todos los atributos y etiquetas <code class="docutils literal notranslate"><span class="pre">HTML</span></code> disponibles están a tu disposición dentro del contexto de <code class="docutils literal notranslate"><span class="pre">Python</span></code>.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="componentes-reutilizables">
<h2>Componentes reutilizables<a class="headerlink" href="#componentes-reutilizables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Escribiendo nuestro markup en <code class="docutils literal notranslate"><span class="pre">Python</span></code>, podemos crear componentes complejos reutilizables como tablas sin cambiar de contexto o de lenguaje. Aquí hay un ejemplo rápido que genera una tabla <code class="docutils literal notranslate"><span class="pre">Table</span></code> a partir de un dataframe de <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>. Crea un archivo llamado <code class="docutils literal notranslate"><span class="pre">app.py</span></code> con el siguiente código</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/usa-agricultural-exports-2011.csv&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_table</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">Table</span><span class="p">([</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Thead</span><span class="p">(</span>
            <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Th</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tbody</span><span class="p">([</span>
            <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">])</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">),</span> <span class="n">max_rows</span><span class="p">))</span>
        <span class="p">])</span>
    <span class="p">])</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H4</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="s1">&#39;US Agriculture Exports (2011)&#39;</span><span class="p">),</span>
    <span class="n">generate_table</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="p">])</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
<p><img alt="" src="_images/dash15.png" /></p>
</div>
<div class="section" id="mas-informacion-sobre-la-visualizacion">
<h2>Más información sobre la visualización<a class="headerlink" href="#mas-informacion-sobre-la-visualizacion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>La librería <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> incluye un componente llamado <code class="docutils literal notranslate"><span class="pre">Graph</span></code>. <code class="docutils literal notranslate"><span class="pre">Graph</span></code> muestra visualizaciones de datos interactivas utilizando la librería de gráficos de código abierto <code class="docutils literal notranslate"><span class="pre">plotly.js</span></code>. <code class="docutils literal notranslate"><span class="pre">Plotly.js</span></code> admite más de 35 tipos de gráficos y los representa tanto en <code class="docutils literal notranslate"><span class="pre">SVG</span></code> de calidad vectorial como en <code class="docutils literal notranslate"><span class="pre">WebGL</span></code> de alto rendimiento.</p></li>
<li><p>El argumento de figura en el <code class="docutils literal notranslate"><span class="pre">componenteGraph</span></code> es el mismo argumento de figura que utiliza <code class="docutils literal notranslate"><span class="pre">plotly.py</span></code>, la biblioteca de gráficos <code class="docutils literal notranslate"><span class="pre">Python</span></code> de código abierto de <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>. Consulte la documentación y la galería de <a class="reference external" href="https://plotly.com/python/">plotly.py para obtener más información</a>. Aquí presentamos un ejemplo que crea un gráfico de dispersión a partir de un marco de datos de <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>. Cree un archivo llamado <code class="docutils literal notranslate"><span class="pre">app.py</span></code> con el siguiente código:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/gdp-life-exp-2007.csv&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdp per capita&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;life expectancy&quot;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="s2">&quot;population&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
                 <span class="n">log_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;life-exp-vs-gdp&#39;</span><span class="p">,</span>
        <span class="n">figure</span><span class="o">=</span><span class="n">fig</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash16.png" /></p>
</div>
<div class="section" id="markdown">
<h2>Markdown<a class="headerlink" href="#markdown" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Aunque <code class="docutils literal notranslate"><span class="pre">Dash</span></code> expone <code class="docutils literal notranslate"><span class="pre">HTML</span></code> a través de <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) , puede ser tedioso escribir tu copia en <code class="docutils literal notranslate"><span class="pre">HTML</span></code>. Para escribir bloques de texto, puedes utilizar el componente <code class="docutils literal notranslate"><span class="pre">Markdown</span></code> en <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code>. Crea un archivo llamado <a class="reference external" href="http://app.py">app.py</a> con el siguiente código:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">markdown_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">### Dash and Markdown</span>

<span class="s1">- Dash apps can be written in Markdown. </span>
<span class="s1">- Dash uses the [CommonMark](http://commonmark.org/) specification of Markdown. </span>
<span class="s1">- Check out their [60 Second Markdown Tutorial](http://commonmark.org/help/) if this is your first introduction to Markdown!</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Markdown</span><span class="p">(</span><span class="n">children</span><span class="o">=</span><span class="n">markdown_text</span><span class="p">)</span>
<span class="p">])</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash17.png" /></p>
</div>
<div class="section" id="componentes-principales">
<h2>Componentes principales<a class="headerlink" href="#componentes-principales" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> incluye un conjunto de componentes de alto nivel como los desplegables, los gráficos, los bloques markdown, etc.</p></li>
<li><p>Como todos los componentes de <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, se describen de forma totalmente declarativa. Cada opción configurable está disponible como un argumento de palabra clave del componente.</p></li>
<li><p>Veremos muchos de estos componentes a lo largo de la sección. Puedes ver todos los componentes disponibles en la <a class="reference external" href="https://dash.plotly.com/dash-core-components">Galería de componentes del núcleo de Dash</a>.</p></li>
<li><p>Aquí están algunos de los componentes disponibles. Crea un archivo llamado <code class="docutils literal notranslate"><span class="pre">app.py</span></code> con el siguiente código:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Dropdown&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NYC&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Montréal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;MTL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;SF&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="n">value</span><span class="o">=</span><span class="s1">&#39;MTL&#39;</span>
    <span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Multi-Select Dropdown&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NYC&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Montréal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;MTL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;SF&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MTL&#39;</span><span class="p">,</span> <span class="s1">&#39;SF&#39;</span><span class="p">],</span>
        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Radio Items&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NYC&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Montréal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;MTL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;SF&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="n">value</span><span class="o">=</span><span class="s1">&#39;MTL&#39;</span>
    <span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Checkboxes&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Checklist</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;NYC&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;Montréal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;MTL&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;SF&#39;</span><span class="p">}</span>
        <span class="p">],</span>
        <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MTL&#39;</span><span class="p">,</span> <span class="s1">&#39;SF&#39;</span><span class="p">]</span>
    <span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Text Input&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;MTL&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Slider&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span>
        <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="nb">max</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
        <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="s1">&#39;Label </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)},</span>
        <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;columnCount&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash18.png" /></p>
<p><strong>Resumen</strong></p>
<ul class="simple">
<li><p>El diseño de una aplicación <code class="docutils literal notranslate"><span class="pre">Dash</span></code> describe el aspecto de la aplicación. El diseño es un árbol jerárquico de componentes. La librería <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> (<code class="docutils literal notranslate"><span class="pre">dash.html</span></code> a partir de <code class="docutils literal notranslate"><span class="pre">Dash</span> <span class="pre">v2.0</span></code>) proporciona clases para todas las etiquetas <code class="docutils literal notranslate"><span class="pre">HTML</span></code> y los argumentos de las palabras clave describen los atributos <code class="docutils literal notranslate"><span class="pre">HTML</span></code> como <code class="docutils literal notranslate"><span class="pre">style,</span> <span class="pre">class</span></code> e <code class="docutils literal notranslate"><span class="pre">id</span></code>. La biblioteca <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> genera componentes de nivel superior como controles y gráficos.</p></li>
<li><p>Para consultar la referencia, ver:</p>
<ul>
<li><p><a class="reference external" href="https://dash.plotly.com/dash-core-components">Galería de componentes del núcleo de Dash</a></p></li>
<li><p><a class="reference external" href="https://dash.plotly.com/dash-html-components">Galería de componentes HTML de Dash</a></p></li>
</ul>
</li>
</ul>
<p>La siguiente parte de esta seccíon cubre cómo hacer estas aplicaciones interactivas. Luego estudiaremos con más profundidad algunos <code class="docutils literal notranslate"><span class="pre">Callbacks</span></code> básicos</p>
</div>
</div>
<div class="section" id="callbacks-basicos-dash">
<h1>Callbacks básicos Dash<a class="headerlink" href="#callbacks-basicos-dash" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Como se ha visto, que <code class="docutils literal notranslate"><span class="pre">app.layout</span></code> describe el aspecto de la aplicación y es un árbol jerárquico de componentes. La biblioteca <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code> proporciona clases para todas las etiquetas <code class="docutils literal notranslate"><span class="pre">HTML</span></code>, y los argumentos de las palabras clave describen los atributos <code class="docutils literal notranslate"><span class="pre">HTML</span></code> como style, <code class="docutils literal notranslate"><span class="pre">className</span></code> e <code class="docutils literal notranslate"><span class="pre">id</span></code>. La biblioteca <code class="docutils literal notranslate"><span class="pre">dash_core_components</span></code> genera componentes de nivel superior como controles y gráficos.</p></li>
<li><p>Ahora se describirá cómo hacer que tus aplicaciones <code class="docutils literal notranslate"><span class="pre">Dash</span></code> utilicen funciones de devolución de llamada (<code class="docutils literal notranslate"><span class="pre">callbacks</span></code>): funciones que son llamadas automáticamente por <code class="docutils literal notranslate"><span class="pre">Dash</span></code> cada vez que la propiedad de un componente de entrada cambia. Comencemos con un ejemplo sencillo de una aplicación Dash interactiva.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H6</span><span class="p">(</span><span class="s2">&quot;Change the value in the text box to see callbacks in action!&quot;</span><span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="s2">&quot;Input: &quot;</span><span class="p">,</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;my-input&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;initial value&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;my-output&#39;</span><span class="p">),</span>

<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;my-output&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;my-input&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">update_output_div</span><span class="p">(</span><span class="n">input_value</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;Output: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Observaciones</strong></p>
<ul>
<li><p>Las “<code class="docutils literal notranslate"><span class="pre">inputs</span></code>” y “<code class="docutils literal notranslate"><span class="pre">outputs</span></code>” de la interfaz de nuestra aplicación se describen declarativamente como argumentos del decorador <code class="docutils literal notranslate"><span class="pre">&#64;app.callback</span></code>.</p>
<p>a. Al escribir este decorador, le estamos diciendo a <code class="docutils literal notranslate"><span class="pre">Dash</span></code> que llame a esta función por nosotros cada vez que el valor del componente “<code class="docutils literal notranslate"><span class="pre">input</span></code>” (<code class="docutils literal notranslate"><span class="pre">la</span> <span class="pre">caja</span> <span class="pre">de</span> <span class="pre">texto</span></code>) cambie para actualizar los <code class="docutils literal notranslate"><span class="pre">children</span></code> del componente “<code class="docutils literal notranslate"><span class="pre">output</span></code>” en la página (el <code class="docutils literal notranslate"><span class="pre">div</span> <span class="pre">HTML</span></code>).</p>
<p>b. Puedes usar cualquier nombre para la función que está envuelta por el decorador <code class="docutils literal notranslate"><span class="pre">&#64;app.callback</span></code>. La convención es que el nombre describa la(s) salida(s) del <code class="docutils literal notranslate"><span class="pre">callback</span></code>.</p>
<p>c. Puede utilizar cualquier nombre para los argumentos de la función, pero debe utilizar los mismos nombres dentro de la función de devolución de llamada que en su definición, al igual que en una función normal de <code class="docutils literal notranslate"><span class="pre">Python</span></code>. Los argumentos son posicionales por defecto: primero los elementos de entrada y luego los elementos de estado se dan en el mismo orden que en el decorador. También tiene la opción de utilizar argumentos de palabra clave con nombre, en lugar de posicionales.</p>
<p>d. Debes utilizar el mismo <code class="docutils literal notranslate"><span class="pre">id</span></code> que le diste a un componente <code class="docutils literal notranslate"><span class="pre">Dash</span></code> en el <code class="docutils literal notranslate"><span class="pre">app.layout</span></code> cuando te refieras a él como entrada o salida del decorador <code class="docutils literal notranslate"><span class="pre">&#64;app.callback</span></code>.</p>
<p>e. El decorador <code class="docutils literal notranslate"><span class="pre">&#64;app.callback</span></code> debe estar directamente encima de la declaración de la función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. Si hay una línea en blanco entre el decorador y la definición de la función, el registro de la devolución de llamada no tendrá éxito.</p>
</li>
<li><p>En <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, los <code class="docutils literal notranslate"><span class="pre">inputs</span></code> y <code class="docutils literal notranslate"><span class="pre">outputs</span></code> de nuestra aplicación son simplemente las propiedades de un componente en particular. En este ejemplo, nuestro <code class="docutils literal notranslate"><span class="pre">input</span></code> es la propiedad “<code class="docutils literal notranslate"><span class="pre">value</span></code>” del componente que tiene el <code class="docutils literal notranslate"><span class="pre">ID</span></code> “<code class="docutils literal notranslate"><span class="pre">my-input</span></code>”. Nuestra salida es la propiedad “<code class="docutils literal notranslate"><span class="pre">children</span></code>” del componente con el <code class="docutils literal notranslate"><span class="pre">ID</span></code> “<code class="docutils literal notranslate"><span class="pre">my-input</span></code>”.</p></li>
<li><p>Cada vez que una propiedad de entrada cambia, la función que el decorador <code class="docutils literal notranslate"><span class="pre">callback</span></code> envuelve será llamada automáticamente. <code class="docutils literal notranslate"><span class="pre">Dash</span></code> proporciona a la función el nuevo valor de la propiedad de entrada como argumento de entrada y <code class="docutils literal notranslate"> <span class="pre">Dash</span></code> actualiza la propiedad del componente de salida con lo que haya devuelto la función.</p></li>
<li><p>Las palabras clave <code class="docutils literal notranslate"><span class="pre">component_id</span></code> y <code class="docutils literal notranslate"><span class="pre">component_property</span></code> son opcionales (sólo hay dos argumentos para cada uno de esos objetos). Se incluyen en este ejemplo para mayor claridad, pero se omitirán en el resto de la sección en aras de la brevedad y la legibilidad.</p></li>
<li><p>No confunda el objeto <code class="docutils literal notranslate"><span class="pre">dash.dependencies.Input</span></code> con el objeto <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code>. El primero sólo se utiliza en estas definiciones de <code class="docutils literal notranslate"><span class="pre">callback</span></code> y el segundo es un componente real.</p></li>
<li><p>Nótese que no establecemos un valor para la propiedad <code class="docutils literal notranslate"><span class="pre">children</span></code> del componente <code class="docutils literal notranslate"><span class="pre">my-output</span></code> en el <code class="docutils literal notranslate"><span class="pre">layout</span></code>. Cuando la aplicación <code class="docutils literal notranslate"><span class="pre">Dash</span></code> se inicia, llama automáticamente a todos los <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> con los valores iniciales de los componentes de entrada para rellenar el estado inicial de los componentes de salida. En este ejemplo, si se especifica algo como <code class="docutils literal notranslate"><span class="pre">html.Div(id='my-output',</span> <span class="pre">children='Hola</span> <span class="pre">mundo')</span></code>, se sobrescribiría cuando la aplicación se inicia.</p></li>
<li><p>Con la interactividad de <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, podemos actualizar dinámicamente cualquier propiedad a través de una función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. ¡Frecuentemente actualizaremos los <code class="docutils literal notranslate"><span class="pre">children</span></code> de un componente para mostrar nuevo texto o la figura de un componente <code class="docutils literal notranslate"><span class="pre">dcc.Graph</span></code> para mostrar nuevos datos, pero también podríamos actualizar el estilo de un componente o incluso las opciones disponibles de un componente <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code>. Veamos otro ejemplo en el que un <code class="docutils literal notranslate"><span class="pre">dcc.Slider</span></code> actualiza un <code class="docutils literal notranslate"><span class="pre">dcc.Graph</span></code>.</p></li>
</ul>
<div class="section" id="dash-app-layout-con-figura-y-sliderm">
<h2>Dash App Layout con Figura y Sliderm<a class="headerlink" href="#dash-app-layout-con-figura-y-sliderm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/gapminderDataFiveYear.csv&#39;</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;graph-with-slider&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;year-slider&#39;</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="n">value</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()},</span>
        <span class="n">step</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;graph-with-slider&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;year-slider&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">update_figure</span><span class="p">(</span><span class="n">selected_year</span><span class="p">):</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">selected_year</span><span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
                     <span class="n">log_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">transition_duration</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash19.png" /></p>
<ul class="simple">
<li><p>Recuerde que siempre puede cambiar el estilo de su figura y la hoja. Sólo debe cambiar las siguientes lineas</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ext_style</span> <span class="o">=</span> <span class="s2">&quot;https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/slate/bootstrap.min.css&quot;</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span><span class="n">ext_style</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span>
                 <span class="n">size</span><span class="o">=</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span>
                 <span class="n">log_x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size_max</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s2">&quot;plotly_dark&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash20.png" /></p>
<ul class="simple">
<li><p>En este ejemplo, la propiedad “<code class="docutils literal notranslate"><span class="pre">value</span></code>” del <code class="docutils literal notranslate"><span class="pre">dcc.Slider</span></code> es la entrada de la app y la salida de la app es la propiedad “<code class="docutils literal notranslate"><span class="pre">figure</span></code>” del <code class="docutils literal notranslate"><span class="pre">dcc.Graph</span></code>. Cada vez que el valor del <code class="docutils literal notranslate"><span class="pre">dcc.Slider</span></code> cambia, <code class="docutils literal notranslate"><span class="pre">Dash</span></code> llama a la función callback <code class="docutils literal notranslate"><span class="pre">update_figure</span></code> con el nuevo valor. La función filtra el dataframe con este nuevo valor, construye un objeto figura y lo devuelve a la aplicación <code class="docutils literal notranslate"><span class="pre">Dash</span></code>.</p></li>
<li><p>Hay algunos patrones agradables en este ejemplo:</p>
<ul>
<li><p>Utilizamos la biblioteca <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> para cargar nuestro <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> al inicio de la aplicación: <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> <span class="pre">pd.read_csv('...')</span></code>. Este dataframe <code class="docutils literal notranslate"><span class="pre">df</span></code> está en el estado global de la app y puede ser leído dentro de las funciones callback.</p></li>
<li><p>La carga de datos en memoria puede ser costosa. Al cargar los datos de consulta al inicio de la app en lugar de dentro de las funciones callback, nos aseguramos de que esta operación sólo se realiza cuando se inicia el servidor de la app. Cuando un usuario visita la app o interactúa con ella, esos datos (<code class="docutils literal notranslate"><span class="pre">df</span></code>) ya están en memoria. Si es posible, la inicialización costosa (como la descarga o la consulta de datos) debería hacerse en el ámbito global de la app en lugar de dentro de las funciones callback.</p></li>
<li><p>El callback no modifica los datos originales, sólo crea copias del dataframe filtrando a través de los filtros de pandas. Esto es importante: sus callbacks nunca deben mutar las variables fuera de su ámbito. Si tus callbacks modifican el estado global, entonces la sesión de un usuario podría afectar a la sesión del siguiente usuario y cuando la aplicación se despliegue en múltiples procesos o hilos, esas modificaciones no se compartirán entre sesiones.</p></li>
<li><p>Activamos las transiciones con <code class="docutils literal notranslate"><span class="pre">layout.transition</span></code> para dar una idea de cómo evoluciona el conjunto de datos con el tiempo: las transiciones permiten que el gráfico se actualice de un estado a otro de forma suave, como si estuviera animado.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="aplicacion-dash-con-multiples-entradas">
<h2>Aplicación Dash con múltiples entradas<a class="headerlink" href="#aplicacion-dash-con-multiples-entradas" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>En <code class="docutils literal notranslate"><span class="pre">Dash</span></code>, cualquier “<code class="docutils literal notranslate"><span class="pre">Output</span></code>” puede tener múltiples componentes “<code class="docutils literal notranslate"><span class="pre">Input</span></code>”. Aquí hay un ejemplo simple que une cinco <code class="docutils literal notranslate"><span class="pre">Inputs</span></code> (la propiedad value de dos componentes <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code>, dos componentes <code class="docutils literal notranslate"><span class="pre">dcc.RadioItems</span></code>, y un componente <code class="docutils literal notranslate"><span class="pre">dcc.Slider</span></code>) a 1 componente <code class="docutils literal notranslate"><span class="pre">Output</span></code> (la propiedad figure del componente <code class="docutils literal notranslate"><span class="pre">Graph</span></code>). Observe cómo <code class="docutils literal notranslate"><span class="pre">app.callback</span></code> enumera los cinco elementos de entrada después de la salida.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/country_indicators.csv&#39;</span><span class="p">)</span>

<span class="n">available_indicators</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>

        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;xaxis-column&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">available_indicators</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Fertility rate, total (births per woman)&#39;</span>
            <span class="p">),</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;xaxis-type&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Log&#39;</span><span class="p">]],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span>
                <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;48%&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>

        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;yaxis-column&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">available_indicators</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Life expectancy at birth, total (years)&#39;</span>
            <span class="p">),</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;yaxis-type&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Log&#39;</span><span class="p">]],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span>
                <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;48%&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">})</span>
    <span class="p">]),</span>

    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;indicator-graphic&#39;</span><span class="p">),</span>

    <span class="n">dcc</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;year--slider&#39;</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="n">value</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()},</span>
        <span class="n">step</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;indicator-graphic&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;xaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;yaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;xaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;yaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;year--slider&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">xaxis_column_name</span><span class="p">,</span> <span class="n">yaxis_column_name</span><span class="p">,</span>
                 <span class="n">xaxis_type</span><span class="p">,</span> <span class="n">yaxis_type</span><span class="p">,</span>
                 <span class="n">year_value</span><span class="p">):</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year_value</span><span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">xaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span>
                     <span class="n">y</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span>
                     <span class="n">hover_name</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Country Name&#39;</span><span class="p">])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">xaxis_column_name</span><span class="p">,</span>
                     <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span> <span class="k">if</span> <span class="n">xaxis_type</span> <span class="o">==</span> <span class="s1">&#39;Linear&#39;</span> <span class="k">else</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">yaxis_column_name</span><span class="p">,</span>
                     <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span> <span class="k">if</span> <span class="n">yaxis_type</span> <span class="o">==</span> <span class="s1">&#39;Linear&#39;</span> <span class="k">else</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash21.png" /></p>
<ul class="simple">
<li><p>En este ejemplo, la llamada de retorno se ejecuta cada vez que cambia la propiedad value de los componentes <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown,</span> <span class="pre">dcc.Slider</span></code> o <code class="docutils literal notranslate"><span class="pre">dcc.RadioItems</span></code>. Los argumentos de entrada de la llamada de retorno son el valor nuevo o actual de cada una de las propiedades de entrada, en el orden en que fueron especificadas.</p></li>
<li><p>Aunque sólo un único <code class="docutils literal notranslate"><span class="pre">Input</span></code> cambia a la vez (un usuario sólo puede cambiar el valor de un único <code class="docutils literal notranslate"><span class="pre">Dropdown</span></code> en un momento dado), <code class="docutils literal notranslate"><span class="pre">Dash</span></code> recoge el estado actual de todas las propiedades <code class="docutils literal notranslate"><span class="pre">Input</span></code> especificadas y las pasa a su función por usted. Se garantiza que tus funciones <code class="docutils literal notranslate"><span class="pre">callback</span></code> siempre reciben el estado representativo de la aplicación.</p></li>
</ul>
</div>
<div class="section" id="aplicacion-dash-con-multiples-salidas">
<h2>Aplicación Dash con múltiples salidas<a class="headerlink" href="#aplicacion-dash-con-multiples-salidas" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Hasta ahora todos los <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> que hemos escrito sólo actualizan una propiedad de salida. También podemos actualizar varias a la vez: enumera todas las propiedades que quieras actualizar en <code class="docutils literal notranslate"><span class="pre">app.callback</span></code>, y devuelve ese número de elementos desde el <code class="docutils literal notranslate"><span class="pre">callback</span></code>. Esto es particularmente bueno si dos salidas dependen del mismo resultado intermedio computacionalmente intenso, como una consulta lenta a la base de datos.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="n">external_stylesheets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://codepen.io/chriddyp/pen/bWLwgP.css&#39;</span><span class="p">]</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="n">external_stylesheets</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;num-multi&#39;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Table</span><span class="p">([</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">Sup</span><span class="p">(</span><span class="mi">2</span><span class="p">)]),</span> <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">)]),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">Sup</span><span class="p">(</span><span class="mi">3</span><span class="p">)]),</span> <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;cube&#39;</span><span class="p">)]),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">Sup</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)]),</span> <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;twos&#39;</span><span class="p">)]),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">Sup</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)]),</span> <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;threes&#39;</span><span class="p">)]),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Tr</span><span class="p">([</span><span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">.</span><span class="n">Sup</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)]),</span> <span class="n">html</span><span class="o">.</span><span class="n">Td</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;x^x&#39;</span><span class="p">)]),</span>
    <span class="p">]),</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;twos&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;threes&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;x^x&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;num-multi&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">callback_a</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="o">**</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">x</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>No siempre es una buena idea combinar las salidas, aunque se pueda. Si las Salidas dependen de algunas pero no todas las mismas Entradas, mantenerlas separadas puede evitar actualizaciones innecesarias. Si tienen las mismas Entradas pero hacen cálculos independientes con estas entradas, mantener las devoluciones de llamada separadas puede permitir que se ejecuten en paralelo.</p></li>
</ul>
</div>
<div class="section" id="dash-app-con-callbacks-encadenados">
<h2>Dash App con callbacks encadenados<a class="headerlink" href="#dash-app-con-callbacks-encadenados" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>También puedes encadenar salidas y entradas: la salida de una función <code class="docutils literal notranslate"><span class="pre">callback</span></code> puede ser la entrada de otra función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. Este patrón puede ser utilizado para crear <code class="docutils literal notranslate"><span class="pre">UIs</span></code> dinámicas donde un componente de entrada actualiza las opciones disponibles del siguiente componente de entrada</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="n">external_stylesheets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://codepen.io/chriddyp/pen/bWLwgP.css&#39;</span><span class="p">]</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="n">external_stylesheets</span><span class="p">)</span>

<span class="n">all_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;America&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York City&#39;</span><span class="p">,</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;Cincinnati&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Canada&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;Montréal&#39;</span><span class="p">,</span> <span class="s1">&#39;Toronto&#39;</span><span class="p">,</span> <span class="s1">&#39;Ottawa&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;countries-radio&#39;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_options</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
        <span class="n">value</span><span class="o">=</span><span class="s1">&#39;America&#39;</span>
    <span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Hr</span><span class="p">(),</span>

    <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;cities-radio&#39;</span><span class="p">),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Hr</span><span class="p">(),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;display-selected-values&#39;</span><span class="p">)</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;cities-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;countries-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">set_cities_options</span><span class="p">(</span><span class="n">selected_country</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_options</span><span class="p">[</span><span class="n">selected_country</span><span class="p">]]</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;cities-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;cities-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">set_cities_value</span><span class="p">(</span><span class="n">available_options</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">available_options</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;display-selected-values&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;countries-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;cities-radio&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">set_display_children</span><span class="p">(</span><span class="n">selected_country</span><span class="p">,</span> <span class="n">selected_city</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is a city in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">selected_city</span><span class="p">,</span> <span class="n">selected_country</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash22.png" /></p>
<ul class="simple">
<li><p>El primer <code class="docutils literal notranslate"><span class="pre">callback</span></code> actualiza las opciones disponibles en el segundo componente <code class="docutils literal notranslate"><span class="pre">dcc.RadioItems</span></code> basándose en el valor seleccionado en el primer componente <code class="docutils literal notranslate"><span class="pre">dcc.RadioItems</span></code>.</p></li>
<li><p>El segundo <code class="docutils literal notranslate"><span class="pre">callback</span></code> establece un valor inicial cuando la propiedad options cambia: lo establece al primer valor de ese array de opciones.</p></li>
<li><p>La última llamada de retorno muestra el valor seleccionado de cada componente. Si cambia el valor del componente countries <code class="docutils literal notranslate"><span class="pre">dcc.RadioItems</span></code>, <code class="docutils literal notranslate"><span class="pre">Dash</span></code> esperará hasta que se actualice el valor del componente <code class="docutils literal notranslate"><span class="pre">cities</span></code> antes de llamar al <code class="docutils literal notranslate"><span class="pre">callback</span></code> final. Esto evita que sus <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> sean llamados con un estado inconsistente como con “<code class="docutils literal notranslate"><span class="pre">America</span></code>” y “<code class="docutils literal notranslate"><span class="pre">Montréal</span></code>”.</p></li>
</ul>
</div>
<div class="section" id="dash-app-con-estado">
<h2>Dash App con Estado<a class="headerlink" href="#dash-app-con-estado" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>En algunos casos, puede tener un patrón de tipo “formulario” en su aplicación. En esta situación, es posible que quieras leer el valor del componente de entrada, pero sólo cuando el usuario haya terminado de introducir toda su información en el formulario. Adjuntar una llamada de retorno a los valores de entrada directamente puede tener este aspecto:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="n">external_stylesheets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;https://codepen.io/chriddyp/pen/bWLwgP.css&quot;</span><span class="p">]</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="n">external_stylesheets</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;input-1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Montréal&quot;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;input-2&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Canada&quot;</span><span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;number-output&quot;</span><span class="p">),</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;number-output&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input-1&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input-2&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">update_output</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;Input 1 is &quot;</span><span class="si">{}</span><span class="s1">&quot; and Input 2 is &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/dash23.png" /></p>
<ul class="simple">
<li><p>En este ejemplo, la función <code class="docutils literal notranslate"><span class="pre">callback</span></code> se dispara cada vez que cambia alguno de los atributos descritos por la Entrada. Pruébelo usted mismo introduciendo datos en las entradas anteriores. El estado le permite pasar valores adicionales sin disparar las devoluciones de llamada. Aquí está el mismo ejemplo anterior pero con el <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code> como <code class="docutils literal notranslate"><span class="pre">State</span></code> y un botón como <code class="docutils literal notranslate"><span class="pre">Input</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">from</span> <span class="nn">dash.dependencies</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">State</span>
<span class="kn">import</span> <span class="nn">dash_design_kit</span> <span class="k">as</span> <span class="nn">ddk</span>

<span class="n">external_stylesheets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://codepen.io/chriddyp/pen/bWLwgP.css&#39;</span><span class="p">]</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="n">external_stylesheets</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;input-1-state&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Montréal&#39;</span><span class="p">),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;input-2-state&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Canada&#39;</span><span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;submit-button-state&#39;</span><span class="p">,</span> <span class="n">n_clicks</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="s1">&#39;Submit&#39;</span><span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;output-state&#39;</span><span class="p">)</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;output-state&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
              <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;submit-button-state&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
              <span class="n">State</span><span class="p">(</span><span class="s1">&#39;input-1-state&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
              <span class="n">State</span><span class="p">(</span><span class="s1">&#39;input-2-state&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">update_output</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        The Button has been pressed </span><span class="si">{}</span><span class="s1"> times,</span>
<span class="s1">        Input 1 is &quot;</span><span class="si">{}</span><span class="s1">&quot;,</span>
<span class="s1">        and Input 2 is &quot;</span><span class="si">{}</span><span class="s1">&quot;</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>En este ejemplo, el cambio de texto en los cuadros <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code> no disparará el <code class="docutils literal notranslate"><span class="pre">callback</span></code> pero sí lo hará el clic en el botón. Los valores actuales de los valores de <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code> son pasados al <code class="docutils literal notranslate"><span class="pre">callback</span></code> aunque no activen la función <code class="docutils literal notranslate"><span class="pre">callback</span></code> en sí.</p></li>
<li><p>Tenga en cuenta que estamos activando el <code class="docutils literal notranslate"><span class="pre">callback</span></code> escuchando la propiedad <code class="docutils literal notranslate"><span class="pre">n_clicks</span></code> del componente <code class="docutils literal notranslate"><span class="pre">html.Button</span></code>. <code class="docutils literal notranslate"><span class="pre">n_clicks</span></code> es una propiedad que se incrementa cada vez que se hace clic en el componente. Está disponible en todos los componentes de la biblioteca <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code>.</p></li>
</ul>
<p><img alt="" src="_images/dash24.png" /></p>
<ul class="simple">
<li><p>En este ejemplo, el cambio de texto en los cuadros <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code> no disparará el callback pero sí lo hará el clic en el botón. Los valores actuales de los valores de <code class="docutils literal notranslate"><span class="pre">dcc.Input</span></code> son pasados al callback aunque no activen la función callback en sí.</p></li>
<li><p>Tenga en cuenta que estamos activando el callback escuchando la propiedad <code class="docutils literal notranslate"><span class="pre">n_clicks</span></code> del componente <code class="docutils literal notranslate"><span class="pre">html.Button</span></code>. <code class="docutils literal notranslate"><span class="pre">n_clicks</span></code> es una propiedad que se incrementa cada vez que se hace clic en el componente. Está disponible en todos los componentes de la biblioteca <code class="docutils literal notranslate"><span class="pre">dash_html_components</span></code>.</p></li>
<li><p>Hemos cubierto los fundamentos de los <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> en <code class="docutils literal notranslate"><span class="pre">Dash</span></code>. Las aplicaciones <code class="docutils literal notranslate"><span class="pre">Dash</span></code> están construidas a partir de un conjunto de principios simples pero poderosos: <code class="docutils literal notranslate"><span class="pre">UIs</span></code> declarativas que son personalizables a través de callbacks reactivos y funcionales de <code class="docutils literal notranslate"><span class="pre">Python</span></code>. Cada atributo del elemento de los componentes declarativos puede ser actualizado a través de un <code class="docutils literal notranslate"><span class="pre">callback</span></code> y un subconjunto de los atributos, como las propiedades del valor del <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code>, son editables por el usuario en la interfaz.</p></li>
</ul>
</div>
<div class="section" id="actualizar-graficos-al-deslizar-el-cursor">
<h2>Actualizar gráficos al deslizar el cursor<a class="headerlink" href="#actualizar-graficos-al-deslizar-el-cursor" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Actualicemos nuestro ejemplo de indicadores mundiales del capítulo anterior, actualizando las series de tiempo cuando pasamos por encima de los puntos de nuestro gráfico de dispersión.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dash</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">dcc</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">html</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">external_stylesheets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://codepen.io/chriddyp/pen/bWLwgP.css&#39;</span><span class="p">]</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">external_stylesheets</span><span class="o">=</span><span class="n">external_stylesheets</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/country_indicators.csv&#39;</span><span class="p">)</span>

<span class="n">available_indicators</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>

        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-xaxis-column&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">available_indicators</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Fertility rate, total (births per woman)&#39;</span>
            <span class="p">),</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-xaxis-type&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Log&#39;</span><span class="p">]],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span>
                <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginTop&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;49%&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>

        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-yaxis-column&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">available_indicators</span><span class="p">],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Life expectancy at birth, total (years)&#39;</span>
            <span class="p">),</span>
            <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-yaxis-type&#39;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> <span class="s1">&#39;Log&#39;</span><span class="p">]],</span>
                <span class="n">value</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span>
                <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginTop&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;49%&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">})</span>
    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;10px 5px&#39;</span>
    <span class="p">}),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-indicator-scatter&#39;</span><span class="p">,</span>
            <span class="n">hoverData</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;customdata&#39;</span><span class="p">:</span> <span class="s1">&#39;Japan&#39;</span><span class="p">}]}</span>
        <span class="p">)</span>
    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;49%&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;0 20&#39;</span><span class="p">}),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;x-time-series&#39;</span><span class="p">),</span>
        <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;y-time-series&#39;</span><span class="p">),</span>
    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;49%&#39;</span><span class="p">}),</span>

    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;crossfilter-year--slider&#39;</span><span class="p">,</span>
        <span class="nb">min</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="nb">max</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="n">value</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="n">marks</span><span class="o">=</span><span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()},</span>
        <span class="n">step</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;49%&#39;</span><span class="p">,</span> <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;0px 20px 20px 20px&#39;</span><span class="p">})</span>
<span class="p">])</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;crossfilter-indicator-scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-xaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-yaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-xaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-yaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-year--slider&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">xaxis_column_name</span><span class="p">,</span> <span class="n">yaxis_column_name</span><span class="p">,</span>
                 <span class="n">xaxis_type</span><span class="p">,</span> <span class="n">yaxis_type</span><span class="p">,</span>
                 <span class="n">year_value</span><span class="p">):</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year_value</span><span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">xaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span>
            <span class="n">hover_name</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Country Name&#39;</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">customdata</span><span class="o">=</span><span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">][</span><span class="s1">&#39;Country Name&#39;</span><span class="p">])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">xaxis_column_name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span> <span class="k">if</span> <span class="n">xaxis_type</span> <span class="o">==</span> <span class="s1">&#39;Linear&#39;</span> <span class="k">else</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">yaxis_column_name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span> <span class="k">if</span> <span class="n">yaxis_type</span> <span class="o">==</span> <span class="s1">&#39;Linear&#39;</span> <span class="k">else</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>


<span class="k">def</span> <span class="nf">create_time_series</span><span class="p">(</span><span class="n">dff</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dff</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span> <span class="k">if</span> <span class="n">axis_type</span> <span class="o">==</span> <span class="s1">&#39;Linear&#39;</span> <span class="k">else</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">yanchor</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                       <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;paper&#39;</span><span class="p">,</span> <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                       <span class="n">text</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">225</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">fig</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;x-time-series&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-indicator-scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;hoverData&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-xaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-xaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_y_timeseries</span><span class="p">(</span><span class="n">hoverData</span><span class="p">,</span> <span class="n">xaxis_column_name</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">):</span>
    <span class="n">country_name</span> <span class="o">=</span> <span class="n">hoverData</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;customdata&#39;</span><span class="p">]</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Country Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">country_name</span><span class="p">]</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">xaxis_column_name</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&lt;b&gt;</span><span class="si">{}</span><span class="s1">&lt;/b&gt;&lt;br&gt;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">country_name</span><span class="p">,</span> <span class="n">xaxis_column_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">create_time_series</span><span class="p">(</span><span class="n">dff</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;y-time-series&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-indicator-scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;hoverData&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-yaxis-column&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">dash</span><span class="o">.</span><span class="n">dependencies</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;crossfilter-yaxis-type&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_x_timeseries</span><span class="p">(</span><span class="n">hoverData</span><span class="p">,</span> <span class="n">yaxis_column_name</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">):</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Country Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hoverData</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;customdata&#39;</span><span class="p">]]</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Indicator Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yaxis_column_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">create_time_series</span><span class="p">(</span><span class="n">dff</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">,</span> <span class="n">yaxis_column_name</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Intente pasar el mouse por encima de los puntos del gráfico de dispersión de la izquierda. ¿Observa cómo los gráficos de líneas de la derecha se actualizan en función del punto sobre el que pasas el mouse?.</p></li>
</ul>
<p><img alt="" src="_images/dash25.png" /></p>
</div>
</div>
<div class="section" id="dos-ejemplos-de-dash">
<h1>Dos ejemplos de Dash<a class="headerlink" href="#dos-ejemplos-de-dash" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>En esta sección estudiaremos dos ejemplos de app dash para poner en practica los estudiado en las dos primeras secciones. El primero es relacionado con mapas y el segundo con series de tiempo financieras. El objetivo principal es hacer uso de la metdología aprender por ejemplos</p></li>
</ul>
<div class="section" id="dash-app-para-mapas">
<h2>Dash App para Mapas<a class="headerlink" href="#dash-app-para-mapas" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Iniciamos cargando el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a utlizar en nuestra app. Los datos provienen del archivo <code class="docutils literal notranslate"><span class="pre">intro_bees.csv</span></code> que contiene información sobre enfermedades que afectan a ciertas colonias de abejas, en determinados estados en USA. Las columnas de interés en este ejemplo son: <code class="docutils literal notranslate"><span class="pre">['State',</span> <span class="pre">'ANSI',</span> <span class="pre">'Affected</span> <span class="pre">by',</span> <span class="pre">'Year',</span> <span class="pre">'state_code']</span></code>.  El código <code class="docutils literal notranslate"><span class="pre">ANSI</span></code> es el Códigos del Instituto Nacional de Normalización: <code class="docutils literal notranslate"><span class="pre">American</span> <span class="pre">National</span> <span class="pre">Standards</span> <span class="pre">Institute</span> <span class="pre">codes</span> <span class="pre">(ANSI</span> <span class="pre">codes)</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/intro_bees.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Program</th>
      <th>Year</th>
      <th>Period</th>
      <th>State</th>
      <th>ANSI</th>
      <th>Affected by</th>
      <th>Pct of Colonies Impacted</th>
      <th>state_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SURVEY</td>
      <td>2019</td>
      <td>JAN THRU MAR</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>1.8</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>SURVEY</td>
      <td>2019</td>
      <td>JAN THRU MAR</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Other</td>
      <td>3.1</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>SURVEY</td>
      <td>2019</td>
      <td>JAN THRU MAR</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Pesticides</td>
      <td>0.3</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SURVEY</td>
      <td>2019</td>
      <td>JAN THRU MAR</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Pests_excl_Varroa</td>
      <td>22.7</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SURVEY</td>
      <td>2019</td>
      <td>JAN THRU MAR</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Unknown</td>
      <td>9.0</td>
      <td>AL</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Luego agrupamos nuestro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> basados en las columnas de interés y calculamos el porcentaje promedio de colonias afectadas para esta agrupación <code class="docutils literal notranslate"><span class="pre">'Pct</span> <span class="pre">of</span> <span class="pre">Colonies</span> <span class="pre">Impacted'</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;ANSI&#39;</span><span class="p">,</span> <span class="s1">&#39;Affected by&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;state_code&#39;</span><span class="p">])[[</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>ANSI</th>
      <th>Affected by</th>
      <th>Year</th>
      <th>state_code</th>
      <th>Pct of Colonies Impacted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>2015</td>
      <td>AL</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>2016</td>
      <td>AL</td>
      <td>1.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>2017</td>
      <td>AL</td>
      <td>2.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>2018</td>
      <td>AL</td>
      <td>1.30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alabama</td>
      <td>1</td>
      <td>Disease</td>
      <td>2019</td>
      <td>AL</td>
      <td>1.80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Comenzamos a implementar nuestro <code class="docutils literal notranslate"><span class="pre">app.layout</span></code> que como es sabido, esta componente corresponde al “diseño” de la aplicación y describe el aspecto de la misma. <code class="docutils literal notranslate"><span class="pre">html.H1</span></code> recuerde que es una envoltura para el elemento <code class="docutils literal notranslate"><span class="pre">&lt;h1&gt;</span> <span class="pre">de</span> <span class="pre">HTML5</span></code>, elemento de encabezado de primer nivel. Luego de esto escribimos nuestro <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code> con su respectivo <code class="docutils literal notranslate"><span class="pre">id</span></code> el cual sera invocado por nuesta función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. El <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code> corresponde a nuestro menu de opciones, en las que colocamos por defecto <code class="docutils literal notranslate"><span class="pre">value=2015</span></code>. Luego escribimos un nuevo <code class="docutils literal notranslate"><span class="pre">html.Div</span></code> para crear un output que entregue como mensaje cual fué el años seleccionado, esta es una clase <code class="docutils literal notranslate"><span class="pre">children</span></code>, pues depende del input suministrado en el <code class="docutils literal notranslate"><span class="pre">Dropdown</span></code>. Luego agregamos el componente <code class="docutils literal notranslate"><span class="pre">dcc.Graph</span></code> se puede utilizar para renderizar cualquier visualización de datos <code class="docutils literal notranslate"><span class="pre">plotly-powered</span></code>, recibe como argumento <code class="docutils literal notranslate"><span class="pre">figure</span></code>. Nótese que se le asgina también un <code class="docutils literal notranslate"><span class="pre">id</span></code> el cual será leido por nuestro <code class="docutils literal notranslate"><span class="pre">callback</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s2">&quot;Web Application Dashboards with Dash&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">}),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;slct_year&quot;</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2015&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2016&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2016</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2017</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2018</span><span class="p">}],</span>
                 <span class="n">multi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">value</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
                 <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s2">&quot;40%&quot;</span><span class="p">}</span>
                 <span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;output_container&#39;</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[]),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;my_bee_map&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="p">{})</span>
<span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Pasamos a implementar nuestra función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. En nuestro <code class="docutils literal notranslate"><span class="pre">callback</span></code> nótese que tenemos dos outputs, <code class="docutils literal notranslate"><span class="pre">output_container</span></code> que es tipo <code class="docutils literal notranslate"><span class="pre">children</span></code>, recuerde que el propósito de la propiedad children es permitir a los usuarios anidar componentes, tal y como hacemos en <code class="docutils literal notranslate"><span class="pre">HTML</span></code>, en éste caso <code class="docutils literal notranslate"><span class="pre">Input()</span></code> permite a un componente father actualizar datos en el componente children. La función <code class="docutils literal notranslate"><span class="pre">update_graph</span></code> recibe una sola componente, esto es porque tenemos un sólo input, dado que los outputs son dos, uestro <code class="docutils literal notranslate"><span class="pre">callback</span></code> debe también retornar dos objetos, los cuales en este caso llamamos <code class="docutils literal notranslate"><span class="pre">container</span></code> y <code class="docutils literal notranslate"><span class="pre">fig</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;output_container&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;my_bee_map&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;slct_year&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">))</span>

    <span class="n">container</span> <span class="o">=</span> <span class="s2">&quot;The year chosen by user was: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">)</span>

    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">option_slctd</span><span class="p">]</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;Affected by&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Varroa_mites&quot;</span><span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">choropleth</span><span class="p">(</span>
        <span class="n">data_frame</span><span class="o">=</span><span class="n">dff</span><span class="p">,</span>
        <span class="n">locationmode</span><span class="o">=</span><span class="s1">&#39;USA-states&#39;</span><span class="p">,</span>
        <span class="n">locations</span><span class="o">=</span><span class="s1">&#39;state_code&#39;</span><span class="p">,</span>
        <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;usa&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">,</span>
        <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">],</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">sequential</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f Bee Colonies&#39;</span><span class="p">},</span>
        <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">container</span><span class="p">,</span> <span class="n">fig</span>
</pre></div>
</div>
<ul class="simple">
<li><p>La siguiente función ya estudiada anteriormente nos permite ejecutar nuestra aplicación, colocamos la opción <code class="docutils literal notranslate"><span class="pre">debug=True</span></code> para poder activar todas las opciones de debug en nuestra app</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Así vamos a visualizar nuestra plicación luego de cada uno de los paso mencionados anteriormente</p></li>
</ul>
<p><img alt="" src="_images/dash26.png" /></p>
<ul class="simple">
<li><p>El codigo completo utlizado en este ejemplo es el siguiente</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">Dash</span><span class="p">,</span> <span class="n">dcc</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/intro_bees.csv&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;ANSI&#39;</span><span class="p">,</span> <span class="s1">&#39;Affected by&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;state_code&#39;</span><span class="p">])[[</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">H1</span><span class="p">(</span><span class="s2">&quot;Web Application Dashboards with Dash&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">}),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;slct_year&quot;</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2015&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2016&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2016</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2017</span><span class="p">},</span>
                     <span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2018</span><span class="p">}],</span>
                 <span class="n">multi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">value</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span>
                 <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s2">&quot;40%&quot;</span><span class="p">}</span>
                 <span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;output_container&#39;</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[]),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Br</span><span class="p">(),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;my_bee_map&#39;</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="p">{})</span>
<span class="p">])</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;output_container&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;children&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;my_bee_map&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;figure&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="n">component_id</span><span class="o">=</span><span class="s1">&#39;slct_year&#39;</span><span class="p">,</span> <span class="n">component_property</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">):</span>

    <span class="n">container</span> <span class="o">=</span> <span class="s2">&quot;The year chosen by user was: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">option_slctd</span><span class="p">)</span>

    <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">option_slctd</span><span class="p">]</span>
    <span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;Affected by&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Varroa_mites&quot;</span><span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">choropleth</span><span class="p">(</span>
        <span class="n">data_frame</span><span class="o">=</span><span class="n">dff</span><span class="p">,</span>
        <span class="n">locationmode</span><span class="o">=</span><span class="s1">&#39;USA-states&#39;</span><span class="p">,</span>
        <span class="n">locations</span><span class="o">=</span><span class="s1">&#39;state_code&#39;</span><span class="p">,</span>
        <span class="n">scope</span><span class="o">=</span><span class="s2">&quot;usa&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">,</span>
        <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">],</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">sequential</span><span class="o">.</span><span class="n">YlOrRd</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Pct of Colonies Impacted&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f Bee Colonies&#39;</span><span class="p">},</span>
        <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_dark&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">container</span><span class="p">,</span> <span class="n">fig</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dash-app-financiera">
<h2>Dash App Financiera<a class="headerlink" href="#dash-app-financiera" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>En esta aplicación graficaremos el precio de distintos stocks, junto al indicador de análisis tecnico, <code class="docutils literal notranslate"><span class="pre">Bollinger</span> <span class="pre">Bands</span></code>. Este indicador consider para el stock, la media del orden de preferencia, y a esta le suma y resta la desviación estándar para tener la banda. Este indicador en bastante utilziado en análisis financieros, sobre todo cuando deseamos conocer posibles sectores de compra y venta.</p></li>
</ul>
<ul class="simple">
<li><p>Para esta app utlizaremos la librería <code class="docutils literal notranslate"><span class="pre">colorlover</span></code> la cual nos permitirá obtener una escala de colores a elegir para nuestras <code class="docutils literal notranslate"><span class="pre">bollinger</span> <span class="pre">bands</span></code>. Comenzamos por cargar el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que contiene los datos de los stocks de interés: <code class="docutils literal notranslate"><span class="pre">AAPL,</span> <span class="pre">TSLA,</span> <span class="pre">COKE,</span> <span class="pre">YHOO,</span> <span class="pre">GOOGL</span></code>, los cuales aparecen en nuestra columna <code class="docutils literal notranslate"><span class="pre">Stock</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/dash-stock-ticker-demo.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>ExDividend</th>
      <th>SplitRatio</th>
      <th>AdjOpen</th>
      <th>AdjHigh</th>
      <th>AdjLow</th>
      <th>AdjClose</th>
      <th>AdjVolume</th>
      <th>Stock</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2017-12-29</td>
      <td>170.52</td>
      <td>170.590</td>
      <td>169.220</td>
      <td>169.23</td>
      <td>25643711.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>170.52</td>
      <td>170.590</td>
      <td>169.220</td>
      <td>169.23</td>
      <td>25643711.0</td>
      <td>AAPL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2017-12-28</td>
      <td>171.00</td>
      <td>171.850</td>
      <td>170.480</td>
      <td>171.08</td>
      <td>15997739.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>171.00</td>
      <td>171.850</td>
      <td>170.480</td>
      <td>171.08</td>
      <td>15997739.0</td>
      <td>AAPL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2017-12-27</td>
      <td>170.10</td>
      <td>170.780</td>
      <td>169.710</td>
      <td>170.60</td>
      <td>21672062.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>170.10</td>
      <td>170.780</td>
      <td>169.710</td>
      <td>170.60</td>
      <td>21672062.0</td>
      <td>AAPL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2017-12-26</td>
      <td>170.80</td>
      <td>171.470</td>
      <td>169.679</td>
      <td>170.57</td>
      <td>32968167.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>170.80</td>
      <td>171.470</td>
      <td>169.679</td>
      <td>170.57</td>
      <td>32968167.0</td>
      <td>AAPL</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2017-12-22</td>
      <td>174.68</td>
      <td>175.424</td>
      <td>174.500</td>
      <td>175.01</td>
      <td>16052615.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>174.68</td>
      <td>175.424</td>
      <td>174.500</td>
      <td>175.01</td>
      <td>16052615.0</td>
      <td>AAPL</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Luego de cargar nuestro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> nos disponemos a implementar nuestro <code class="docutils literal notranslate"><span class="pre">app.layout</span></code> o “diseño” de la aplicación, tal como lo hicimos con la aplicación anterior. En este caso usamos <code class="docutils literal notranslate"><span class="pre">html.H2</span></code> que es una envoltura para el elemento <code class="docutils literal notranslate"><span class="pre">&lt;h2&gt;</span> <span class="pre">de</span> <span class="pre">HTML5</span></code>, elemento de encabezado de segundo nivel, en este caso también agragamos el logo de <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>, usted puede agragar el logo de su preferencia.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="n">html</span><span class="o">.</span><span class="n">H2</span><span class="p">(</span><span class="s1">&#39;Finance Explorer&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;2.65em&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-left&#39;</span><span class="p">:</span> <span class="s1">&#39;7px&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bolder&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Product Sans&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s2">&quot;rgba(117, 117, 117, 0.95)&quot;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-top&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-bottom&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
                       <span class="p">}),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Img</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://s3-us-west-1.amazonaws.com/plotly-tutorials/logo/new-branding/dash-logo-by-plotly-stripe.png&quot;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;100px&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span>
                <span class="p">},</span>
        <span class="p">),</span>
    <span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Luego de esto escribimos nuestro <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code> con su respectivo <code class="docutils literal notranslate"><span class="pre">id</span></code> el cual sera invocado por nuesta función <code class="docutils literal notranslate"><span class="pre">callback</span></code>. El <code class="docutils literal notranslate"><span class="pre">dcc.Dropdown</span></code> corresponde a nuestro menu de opciones para los diferentes <code class="docutils literal notranslate"><span class="pre">stocks</span></code>, en las que colocamos por defecto una lista con dos stocks <code class="docutils literal notranslate"><span class="pre">['YHOO',</span> <span class="pre">'GOOGL']</span></code>. También creamo una división donde colocaremos cada una de las graficas asociadas a cada stock</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;stock-ticker-input&#39;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
                 <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Stock</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">Stock</span><span class="o">.</span><span class="n">unique</span><span class="p">())],</span>
        <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YHOO&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOGL&#39;</span><span class="p">],</span>
        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;graphs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Definimos la función encargada de calcular nuestro indicado de análisis tecnico. En esta definimos el periodo para nuestra media movil <code class="docutils literal notranslate"><span class="pre">window_size=10</span></code> y además de esto el numero de desviaciones estandar a las que deseamos distar de esta media <code class="docutils literal notranslate"><span class="pre">num_of_std=5</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bbands</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_of_std</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">rolling_mean</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">rolling_std</span>  <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">upper_band</span> <span class="o">=</span> <span class="n">rolling_mean</span> <span class="o">+</span> <span class="p">(</span><span class="n">rolling_std</span><span class="o">*</span><span class="n">num_of_std</span><span class="p">)</span>
    <span class="n">lower_band</span> <span class="o">=</span> <span class="n">rolling_mean</span> <span class="o">-</span> <span class="p">(</span><span class="n">rolling_std</span><span class="o">*</span><span class="n">num_of_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rolling_mean</span><span class="p">,</span> <span class="n">upper_band</span><span class="p">,</span> <span class="n">lower_band</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Definimos ahora nuestra función <code class="docutils literal notranslate"><span class="pre">callback</span></code> la cual tendrá como <code class="docutils literal notranslate"><span class="pre">Output</span></code> en este caso las figuras correspondiente al indicador para cada stock. El mensaje de encabezado <code class="docutils literal notranslate"><span class="pre">&quot;Select</span> <span class="pre">a</span> <span class="pre">stock</span> <span class="pre">ticker.&quot;</span></code> aparecerá si en la caja no aparece ningún stock, indicando que debe seleccionarse el simbolo <code class="docutils literal notranslate"><span class="pre">ticker</span></code> del stock de interés. Una vez recibido este <code class="docutils literal notranslate"><span class="pre">ticker</span></code> filtramos nuestro <code class="docutils literal notranslate"><span class="pre">DataFame</span></code> por <code class="docutils literal notranslate"><span class="pre">Stock</span></code> que coincida con el <code class="docutils literal notranslate"><span class="pre">Inpunt</span> <span class="pre">ticker</span></code> y seleccionamos para este nuevo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> las columnas que necesitamos para el indicador <code class="docutils literal notranslate"><span class="pre">bollinger</span> <span class="pre">band</span></code> y seleccionamos de la escala de colores el color a utlizar en nuestras bandas de bollinger que será el input de la función encargada de calcular las bandas <code class="docutils literal notranslate"><span class="pre">bbands</span></code>, vamos escalando los colores de acuerdo a la banda que se va a dibujar. Vamos a ir agregando a <code class="docutils literal notranslate"><span class="pre">graphs</span></code> cada una de las graficas que vamos obteniendo para mostrarlas todas en nuestra app una debajo de la otra. La figuras van indezadas con <code class="docutils literal notranslate"><span class="pre">id=ticker</span></code> y son obtenidas al realizar la adición <code class="docutils literal notranslate"><span class="pre">[candlestick]</span> <span class="pre">+</span> <span class="pre">bollinger_traces</span></code>. Los siguiente comandos son usados para las dimensiones del margen en nuestra figura y la ubcación de la leyenda: <code class="docutils literal notranslate"><span class="pre">'margin':</span> <span class="pre">{'b':</span> <span class="pre">0,</span> <span class="pre">'r':</span> <span class="pre">10,</span> <span class="pre">'l':</span> <span class="pre">60,</span> <span class="pre">'t':</span> <span class="pre">0},</span></code> y <code class="docutils literal notranslate"><span class="pre">'legend':</span> <span class="pre">{'x':</span> <span class="pre">0}</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;graphs&#39;</span><span class="p">,</span><span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;stock-ticker-input&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">tickers</span><span class="p">):</span>
    <span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">tickers</span><span class="p">:</span>
        <span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">H3</span><span class="p">(</span>
            <span class="s2">&quot;Select a stock ticker.&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginTop&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
        <span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tickers</span><span class="p">):</span>

            <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ticker</span><span class="p">]</span>

            <span class="n">candlestick</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span>
                <span class="s1">&#39;open&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">],</span>
                <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">],</span>
                <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">],</span>
                <span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;candlestick&#39;</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;legendgroup&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;increasing&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
                <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[</span><span class="mi">1</span><span class="p">]}}</span>
            <span class="p">}</span>
            <span class="n">bb_bands</span> <span class="o">=</span> <span class="n">bbands</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">Close</span><span class="p">)</span>
            <span class="n">bollinger_traces</span> <span class="o">=</span> <span class="p">[{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorscale</span><span class="p">)]},</span>
                <span class="s1">&#39;hoverinfo&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;legendgroup&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;showlegend&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> - bollinger bands&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ticker</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bb_bands</span><span class="p">)]</span>
            <span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">ticker</span><span class="p">,</span>
                <span class="n">figure</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">candlestick</span><span class="p">]</span> <span class="o">+</span> <span class="n">bollinger_traces</span><span class="p">,</span>
                    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;margin&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">))</span>

    <span class="k">return</span> <span class="n">graphs</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Así vamos a visualizar nuestra plicación luego de cada uno de los paso mencionados anteriormente</p></li>
</ul>
<p><img alt="" src="_images/dash27.png" /></p>
<ul class="simple">
<li><p>La codigo completo de la app lo presentamos a continuación. Ejecutela desde su terminal o editor <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code> por ejemplo</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dash</span> <span class="kn">import</span> <span class="n">Dash</span><span class="p">,</span> <span class="n">dcc</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span>

<span class="kn">import</span> <span class="nn">colorlover</span> <span class="k">as</span> <span class="nn">cl</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">flask</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">server</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">server</span>

<span class="n">app</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">serve_locally</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">colorscale</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">][</span><span class="s1">&#39;qual&#39;</span><span class="p">][</span><span class="s1">&#39;Paired&#39;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/dash-stock-ticker-demo.csv&#39;</span><span class="p">)</span>

<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="n">html</span><span class="o">.</span><span class="n">H2</span><span class="p">(</span><span class="s1">&#39;Finance Explorer&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;2.65em&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-left&#39;</span><span class="p">:</span> <span class="s1">&#39;7px&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bolder&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Product Sans&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s2">&quot;rgba(117, 117, 117, 0.95)&quot;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-top&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;margin-bottom&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
                       <span class="p">}),</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Img</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://s3-us-west-1.amazonaws.com/plotly-tutorials/logo/new-branding/dash-logo-by-plotly-stripe.png&quot;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;100px&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span>
                <span class="p">},</span>
        <span class="p">),</span>
    <span class="p">]),</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;stock-ticker-input&#39;</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
                 <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Stock</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">Stock</span><span class="o">.</span><span class="n">unique</span><span class="p">())],</span>
        <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YHOO&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOGL&#39;</span><span class="p">],</span>
        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">),</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;graphs&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;container&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bbands</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_of_std</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">rolling_mean</span> <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">rolling_std</span>  <span class="o">=</span> <span class="n">price</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">upper_band</span> <span class="o">=</span> <span class="n">rolling_mean</span> <span class="o">+</span> <span class="p">(</span><span class="n">rolling_std</span><span class="o">*</span><span class="n">num_of_std</span><span class="p">)</span>
    <span class="n">lower_band</span> <span class="o">=</span> <span class="n">rolling_mean</span> <span class="o">-</span> <span class="p">(</span><span class="n">rolling_std</span><span class="o">*</span><span class="n">num_of_std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rolling_mean</span><span class="p">,</span> <span class="n">upper_band</span><span class="p">,</span> <span class="n">lower_band</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;graphs&#39;</span><span class="p">,</span><span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;stock-ticker-input&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">update_graph</span><span class="p">(</span><span class="n">tickers</span><span class="p">):</span>
    <span class="n">graphs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">tickers</span><span class="p">:</span>
        <span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">html</span><span class="o">.</span><span class="n">H3</span><span class="p">(</span>
            <span class="s2">&quot;Select a stock ticker.&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginTop&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
        <span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tickers</span><span class="p">):</span>

            <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ticker</span><span class="p">]</span>

            <span class="n">candlestick</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span>
                <span class="s1">&#39;open&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">],</span>
                <span class="s1">&#39;high&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">],</span>
                <span class="s1">&#39;low&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">],</span>
                <span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;candlestick&#39;</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;legendgroup&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;increasing&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[</span><span class="mi">0</span><span class="p">]}},</span>
                <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[</span><span class="mi">1</span><span class="p">]}}</span>
            <span class="p">}</span>
            <span class="n">bb_bands</span> <span class="o">=</span> <span class="n">bbands</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">Close</span><span class="p">)</span>
            <span class="n">bollinger_traces</span> <span class="o">=</span> <span class="p">[{</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">dff</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">colorscale</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorscale</span><span class="p">)]},</span>
                <span class="s1">&#39;hoverinfo&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="s1">&#39;legendgroup&#39;</span><span class="p">:</span> <span class="n">ticker</span><span class="p">,</span>
                <span class="s1">&#39;showlegend&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> - bollinger bands&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ticker</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bb_bands</span><span class="p">)]</span>
            <span class="n">graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcc</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">ticker</span><span class="p">,</span>
                <span class="n">figure</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">candlestick</span><span class="p">]</span> <span class="o">+</span> <span class="n">bollinger_traces</span><span class="p">,</span>
                    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;margin&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">))</span>

    <span class="k">return</span> <span class="n">graphs</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run_server</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Conclusión</strong></p>
<ul class="simple">
<li><p>Por medio de estas dos aplicaciones se ha abordado cada concepto básico relacionado con el diseño de una app utlizando <code class="docutils literal notranslate"><span class="pre">Dash</span></code> y <code class="docutils literal notranslate"><span class="pre">Plotly</span></code> teniendo en cuenta lo estudiado en secciones anteriores. Ahora procedemos a estudiar como podemos desplegar nuestra aplicación en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code>. Para esto usaremos la cuenta creada en la sección de <code class="docutils literal notranslate"><span class="pre">PostgreSQL</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="despliegue-de-dash-app">
<h1>Despliegue de Dash App<a class="headerlink" href="#despliegue-de-dash-app" title="Permalink to this headline">¶</a></h1>
<div class="section" id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>El despliegue de nuestra aplicación es de suma importancia, para lograr que nuestra app esté disponible para su uso. Por ejemplo si realizas un estudio estadístico predictivo para una compañía que te ha contratado, lo que espera tu cliente es un link con la pagina web de tu app, que le permita acceder al <code class="docutils literal notranslate"><span class="pre">dashboard</span></code> que has diseñado, e interactuar con este utilizando las componentes dinámicas que agregaste antes. Para poder suministrar este link a nuestro cliente necesitamos desplegar nuestra app en una plataforma de servicios de computo en la nube. En este caso usamos <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> por se gratuito y facil de usar.</p></li>
</ul>
<ul class="simple">
<li><p>Iniciaremos creando una nueva aplicación en nuestro dashboard de <code class="docutils literal notranslate"><span class="pre">Heroku</span></code>, en la cual van a reposar todos los archivos que vamos a crear para hacer el despliegue de nuestra aplicación. Para esto accedemos a nuestra cuenta en <code class="docutils literal notranslate"><span class="pre">https://www.heroku.com</span></code> y nos dirigimos al boton <code class="docutils literal notranslate"><span class="pre">New/Create</span> <span class="pre">new</span> <span class="pre">app</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash28.png" /></p>
<ul class="simple">
<li><p>Coloquele un nombre de se preferencia para identificarla y haga click en <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">app</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash29.png" /></p>
<ul class="simple">
<li><p>Luego de crearla podrá visualizar el procedimiento que se debe llevar a cabo para desplegar nuestra <code class="docutils literal notranslate"><span class="pre">app</span></code>. A este paso volveremos al final cuando tengamos preparada la aplicación con los archivos de despliegue correspondientes</p></li>
</ul>
<p><img alt="" src="_images/dash30.png" /></p>
<ul class="simple">
<li><p>Procedemos ahora a crear un proyecto de despliegue para nuestra app. Para esto primero debemos crear una carpeta con el nombre del proyecto, puede usar el nombre de la app creada en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> por ejemplo. Luego, dentro de esta carpeta creamos y activamos un ambiente llamado <code class="docutils literal notranslate"><span class="pre">venv</span></code> en el que instalaremos las librerías que requiere nuestra app para su funcionamiento</p></li>
</ul>
<p><img alt="" src="_images/dash31.png" /></p>
<ul class="simple">
<li><p>Dentro de esta carpeta vamos a pegar el archivo <code class="docutils literal notranslate"><span class="pre">.py</span></code> de nuestra app. Utilizaremos para la edición del resto de archviso necesario y el despliegue de la app el editor <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code>, el cual el de uso libre y puede ser instalado desde el siguiente link <a class="reference external" href="https://code.visualstudio.com/download">VS Code</a></p></li>
</ul>
<p><img alt="" src="_images/dash32.png" /></p>
<ul class="simple">
<li><p>Vamos a abrir nuestra app utilizando usando <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code> y vamos a agregar la siguiente linea de código: <code class="docutils literal notranslate"><span class="pre">server</span> <span class="pre">=</span> <span class="pre">app.server</span></code> justo despues que creamos la instancia de nuestra app. Esta línea permitirá que <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> reconozca tu app y la conecte el servidor</p></li>
</ul>
<p><img alt="" src="_images/dash33.png" /></p>
<ul class="simple">
<li><p>En su terminal de <code class="docutils literal notranslate"><span class="pre">Powershel</span></code> ingrese a la carpeta donde está su proyecto e instale con el enviroment activo, todas las librerías que su aplicación necesitará para su funcionamiento. En este caso para la app financiera que hemos estudiado en la sección pasada necesitaremos, la última del listado es de gran importancia, dado que la necesita <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> para correr nuestra aplicación en el servidor</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">plotly</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">dash</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">colorlover</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gunicorn</span></code></p></li>
</ul>
</li>
</ul>
<p><img alt="" src="_images/dash34.png" /></p>
<ul class="simple">
<li><p>El siguiente paso es crear un un nuevo archivo que nombraremos <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code>. Este archivo le dirá a <code class="docutils literal notranslate"><span class="pre">git</span></code> que debe ignorar como parte de tu proyecto. El archivo debe contener lo siguiente, y lo crearemos usando <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">venv</span> <span class="pre">*.pyc</span> <span class="pre">.DS_Store</span> <span class="pre">.env</span></code></p>
<p><img alt="" src="_images/dash35.png" />
<img alt="" src="_images/dash36.png" /></p>
<ul class="simple">
<li><p>De la misma forma ahora crearemos dentro de la misma carpeta del proyecto un nuevo archivo que nombraremos <code class="docutils literal notranslate"><span class="pre">Procfile</span></code> y la siguiente línea de código dentro. Nótese que <code class="docutils literal notranslate"><span class="pre">app_finance</span></code> se refiere al nombre del archivo <code class="docutils literal notranslate"><span class="pre">.py</span></code> de nuestra app, <code class="docutils literal notranslate"><span class="pre">server</span></code> se refiere a la variable server dentro de ese archivo.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">web:</span> <span class="pre">app_finance:server</span></code></p>
<p><img alt="" src="_images/dash37.png" /></p>
<ul class="simple">
<li><p>Ahora creamos el archivo de requirements, el cual <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> usará para identificar que tipo de librería a descargar. Para esto dentro de su terminal escriba <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span> <span class="pre">&gt;</span> <span class="pre">requirements.txt</span></code>. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span></code> se encarga de generar un archivo de requisitos <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> para isntalar en mismo ambiente en otro entorno, en este caso <code class="docutils literal notranslate"><span class="pre">Heroku</span></code>. Pruebe la terminal de <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code> esta vez para que se familiarice también con su uso. Nótese que se debe selecionar como <code class="docutils literal notranslate"><span class="pre">interpreter</span></code> en <code class="docutils literal notranslate"><span class="pre">VS</span> <span class="pre">Code</span></code> el ambiente creado para el proyecto. Verifique también que la app funciona correctamente en este enviroment. Nótese que al final de la compilación se crea el archivo de requirements en nuestro proyecto</p></li>
</ul>
<p><img alt="" src="_images/dash38.png" /></p>
<ul class="simple">
<li><p>El siguiente paso es logearse en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> para poder usar el cliente, <code class="docutils literal notranslate"><span class="pre">Heroku</span> <span class="pre">CLI</span></code> el cual usaremos de ahora en adelante para subir nuestro proyecto a la nube. Para esto desde la misma terminal ejecutamos el siguiente comando para acceder al cliente, este abrirá la venta en su navegador para el login y luego podrá hacer uso del cliente. Es el mismo procedimiento realizado en la importación de la base de datos en <code class="docutils literal notranslate"><span class="pre">Heroku</span> <span class="pre">Postgres</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">login</span></code></p>
<p><img alt="" src="_images/dash39.png" /></p>
<ul class="simple">
<li><p>Ahora use: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span></code> para iniciar en un repositorio <code class="docutils literal notranslate"><span class="pre">git</span></code> el cual será utilizado por <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> para pushear nuestro proyecto en la nube. Debe aparecer el mensaje de inicialización de un repositorio <code class="docutils literal notranslate"><span class="pre">git</span></code> vacio. Los pasos siguientes aparecen en nuestra app creada en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash40.png" /></p>
<ul class="simple">
<li><p>Luego utlice el siguiente comando: <code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">git:remote</span> <span class="pre">-a</span> <span class="pre">dash-app-finance-lrubio</span></code>, para agregar remotamente con <code class="docutils literal notranslate"><span class="pre">git</span></code> la repo correspondiente al proyecto en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code>. Tenga en cuenta que debe escribir el nombre de la app creada en <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> correctamente. El comando usado antetirmente crea un nuevo control remoto con el nombre de nuestra app ubicado en el repositorio inicializado, una vez que haga esto, usando compandos <code class="docutils literal notranslate"><span class="pre">push</span></code> se puede empujar el proyecto a <code class="docutils literal notranslate"><span class="pre">Heroku</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash41.png" /></p>
<ul class="simple">
<li><p>Luego use los siguientes comandos para empujar nuestro proyecto a <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> usando <code class="docutils literal notranslate"><span class="pre">git</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-am</span> <span class="pre">&quot;App</span> <span class="pre">Launch&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">heroku</span> <span class="pre">master</span></code></p></li>
</ul>
</li>
</ul>
<p><img alt="" src="_images/dash42.png" /></p>
<ul class="simple">
<li><p>Luego de hacer push. Debe esperar un momento a que se instale todo lo que necesita <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> para desplegar nuestra app en su servidor. Esta proceso puede tomar unos cuantos minutos. Al final debe aparecer el siguiente mensaje con el link del domino de nuestra app con el nombre que utlizamos para identificarla y el de <code class="docutils literal notranslate"><span class="pre">Heroku</span></code>, en este caso: <code class="docutils literal notranslate"><span class="pre">https://dash-app-finance-lrubio.herokuapp.com/</span></code>. Haga click sobre este link y podrá visualizar sua plicación web</p></li>
</ul>
<p><img alt="" src="_images/dash43.png" /></p>
<ul class="simple">
<li><p>Si desea hacer un cambio, porque por ejemplo obtuvo errores, debe hacerlos en el directorio de su proyecto y clonarlo nuevamente con los nuevos cambios siguiendo los siguientes pasos, que anteriormente ejecutó. Primero ejecute</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">heroku</span> <span class="pre">git:clone</span> <span class="pre">-a</span> <span class="pre">dash-app-finance-lrubio</span></code></p>
<ul class="simple">
<li><p>Luego sobre el archivo clonado copie los archivos que modificó para corregir el error, y luego realice los siguientes pasos para subir nuevamente su proyecto</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">dash-app-finance-lrubio</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-am</span> <span class="pre">&quot;make</span> <span class="pre">it</span> <span class="pre">better&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">heroku</span> <span class="pre">master</span></code></p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Desde su cuenta de <code class="docutils literal notranslate"><span class="pre">Heroku</span></code> también puede desplegar la aplicación haciendo click en <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">app</span></code></p></li>
</ul>
<p><img alt="" src="_images/dash43.png" /></p>
<ul class="simple">
<li><p>Cuando abra el link obtenido puede visualizar su aplicación. Este link puede entregarselo a un cliente que lo haya contratado para realizar un análisis estadístico predictivo para la toma de decisiones en su compañia</p></li>
</ul>
<p><img alt="" src="_images/dash45.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="section2.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Visualización interactiva de datos geográficos</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Lihki Rubio<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>